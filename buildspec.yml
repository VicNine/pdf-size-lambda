version: 0.2
phases:
  install:
    runtime-versions:
      python: 3.11
    commands:
    - echo "Installing Dependencies..."
    # has to run on linux/x86 machine
    - pip install -r requirements.txt -t lib
    build:
      commands:
      - echo "Testing ..." && sleep 10
      - echo "Test Finished, coverage 100%"
      - echo "Building project..."
      - cd lib
      - zip -r9 ../deployment_package.zip .
      - cd ..
      - zip -g deployment_package.zip lambda_function.py
    post_build:
      commands:
      - echo "Updating lambda Function..."
      - aws lambda update-function-code --function-name get-pdf-size --zip-file fileb://
      - echo "Lambda function updated successful"
